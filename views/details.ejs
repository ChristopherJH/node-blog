<!DOCTYPE html>
<html lang="en">
  <%- include('./partials/head') %>
  <body>
    <%- include('./partials/nav') %>
    <main>
      <div class="details content">
        <h2><%= blog.title %></h2>
        <p><%= blog.createdAt.toLocaleDateString() %></p>
        <div class="content">
          <p><%= blog.snippet %></p>
          <p><%= blog.body %></p>
        </div>
        <div class="content">
          <a href="/blogs">Back</a>
          <a class="delete" data-doc="<%= blog._id %>">Delete</a>
        </div>
      </div>
    </main>
    <%- include('./partials/footer') %>
    <script>
      const deleteBtn = document.querySelector(".delete")
      deleteBtn.addEventListener("click", async (e) => {
        const id = e.target.getAttribute("data-doc")
        try {
          const res = await fetch(`/blogs/${id}`, {
            method: "DELETE",
          })
          if (!res.ok) {
            throw new Error("Error deleting the blog")
          }
          const data = await res.json()
          window.location.replace(data.redirect)
        } catch (err) {
          console.log(err)
        }
      })
    </script>
  </body>
</html>
